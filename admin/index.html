<!doctype html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Content Manager</title>
</head>

<body>
  <!-- Manual init to avoid YAML content-type issues on host -->
  <script>
    window.CMS_MANUAL_INIT = true;
    (function () {
      // optional: normalize URL to /admin/ to keep relative paths sane
      if (location.pathname === "/admin") location.replace("/admin/");
    })();
  </script>

  <!-- Decap CMS -->
  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>

  <script>
    // Initialize Decap CMS with inline config to avoid fetching config.yml with wrong content-type
    CMS.init({
      config: {
        local_backend: true,
        backend: {
          name: 'github',
          repo: 'Francis365/femme-essentials',
          branch: 'main',
          base_url: 'https://decap-oauth-provider-2l6t.onrender.com'
        },
        media_folder: 'shared_images',
        public_folder: 'shared_images',
        publish_mode: 'editorial_workflow',
        collections: [
          {
            name: 'catalog',
            label: 'Product Catalog',
            label_singular: 'Product',
            editor: { preview: false },
            files: [
              {
                file: 'data/products.json',
                label: 'Products',
                name: 'products',
                format: 'json',
                description: 'List of products used across the site',
                fields: [
                  {
                    label: 'Products',
                    name: 'products',
                    widget: 'list',
                    collapsed: true,
                    add_to_top: true,
                    summary: '{{fields.name}} — ₦{{fields.price_ngn}} ({{fields.category}})',
                    fields: [
                      { label: 'Image', name: 'image', widget: 'image', allow_multiple: false, required: false, hint: 'Upload/select image; filename will be auto-derived.' },
                      { label: 'Filename (optional)', name: 'filename', widget: 'string', required: false, hint: 'Only needed if you prefer entering a basename manually.' },
                      { label: 'Name', name: 'name', widget: 'string' },
                      { label: 'Category', name: 'category', widget: 'select', options: ['Wigs', 'Perfume', 'Body Lotion', 'Soap', 'Skin Care', 'Makeup', 'Accessories'] },
                      { label: 'Description', name: 'description', widget: 'text' },

                      { label: 'Price (NGN)', name: 'price_ngn', widget: 'number', value_type: 'int', min: 0, step: 1, required: false }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    });
  </script>

</body>

</html>